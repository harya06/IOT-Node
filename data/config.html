<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Configuration - IoT Node</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="header-content">
      <h1 class="header-title">
        <span class="icon">âš™ï¸</span>
        Device Configuration
      </h1>
      <a href="/dashboard" class="btn btn-back">â† Back to Dashboard</a>
    </div>
  </header>
  
  <!-- Main Content -->
  <main class="container container-sm">
    <form action="/save-config" method="POST" id="configForm">
      
      <!-- Device Settings Card -->
      <div class="card">
        <div class="card-header">
          <div class="card-icon card-icon-sm">ğŸ”§</div>
          <div>
            <h2 class="card-title">Device Settings</h2>
            <p class="card-subtitle">Configure device identity</p>
          </div>
        </div>
        
        <div class="form-grid">
          <div class="form-group full-width">
            <label for="hardwareId">Hardware ID <span class="required">*</span></label>
            <div class="input-wrapper">
              <span class="input-icon">ğŸ”–</span>
              <input 
                type="text" 
                id="hardwareId" 
                name="hardwareId" 
                value="%HARDWARE_ID%" 
                placeholder="Enter device ID"
                required
              >
            </div>
            <p class="hint">Unique identifier for this device</p>
          </div>
        </div>
      </div>
      
      <!-- Server Configuration Card -->
      <div class="card">
        <div class="card-header">
          <div class="card-icon card-icon-sm">ğŸ–¥ï¸</div>
          <div>
            <h2 class="card-title">Server Configuration</h2>
            <p class="card-subtitle">Configure connection to monitoring server</p>
          </div>
        </div>
        
        <div class="form-grid">
          <div class="form-group">
            <label for="serverIP">Server IP / Hostname <span class="required">*</span></label>
            <div class="input-wrapper">
              <span class="input-icon">ğŸŒ</span>
              <input 
                type="text" 
                id="serverIP" 
                name="serverIP" 
                value="%SERVER_IP%" 
                placeholder="192.168.1.100 or hostname"
                required
              >
            </div>
          </div>
          
          <div class="form-group">
            <label for="serverPort">Port <span class="required">*</span></label>
            <div class="input-wrapper">
              <span class="input-icon">ğŸ”Œ</span>
              <input 
                type="number" 
                id="serverPort" 
                name="serverPort" 
                value="%SERVER_PORT%" 
                placeholder="80"
                min="1"
                max="65535"
                required
              >
            </div>
          </div>
          
          <div class="form-group full-width">
            <label for="path">Server Path</label>
            <div class="input-wrapper">
              <span class="input-icon">ğŸ“</span>
              <input 
                type="text" 
                id="path" 
                name="path" 
                value="%PATH%" 
                placeholder="/wsiot"
              >
            </div>
            <p class="hint">Example: /ws, /api/data, /wsiot</p>
          </div>
        </div>
      </div>
      
      <!-- Communication Protocol Card -->
      <div class="card">
        <div class="card-header">
          <div class="card-icon card-icon-sm">ğŸ“¡</div>
          <div>
            <h2 class="card-title">Communication Protocol</h2>
            <p class="card-subtitle">Select communication method</p>
          </div>
        </div>
        
        <!-- Info box showing current connection type -->
        <div class="info-box" id="connectionInfo">
          ğŸ”— <strong>Connected via:</strong> <span id="connectionType">%CONNECTION_TYPE%</span>
        </div>
        
        <div class="form-grid">
          <div class="form-group">
            <label for="commMode">Mode <span class="required">*</span></label>
            <div class="input-wrapper">
              <span class="input-icon">ğŸ“¡</span>
              <select id="commMode" name="commMode" onchange="toggleMQTT()" required>
                %COMM_OPTIONS%
              </select>
            </div>
            <p class="hint" id="modeHint">Available modes depend on connection type</p>
          </div>
          
          <div class="form-group" id="mqttToken" style="display: none;">
            <label for="accessToken">MQTT Access Token</label>
            <div class="input-wrapper">
              <span class="input-icon">ğŸ”‘</span>
              <input 
                type="text" 
                id="accessToken" 
                name="accessToken" 
                value="%ACCESS_TOKEN%"
                placeholder="Enter access token"
              >
            </div>
            <p class="hint">Required for ThingsBoard or authenticated MQTT</p>
          </div>
        </div>
      </div>
      
      <!-- WiFi Configuration Card -->
      <div class="card" id="wifiCard">
        <div class="card-header">
          <div class="card-icon card-icon-sm">ğŸ“¶</div>
          <div>
            <h2 class="card-title">WiFi Configuration</h2>
            <p class="card-subtitle">Configure wireless connection</p>
          </div>
        </div>
        
        <div class="info-box">
          ğŸ’¡ <strong>Tip:</strong> WiFi credentials for station mode connection
        </div>
        
        <div class="form-grid">
          <div class="form-group">
            <label for="ssid">SSID <span class="required">*</span></label>
            <div class="input-wrapper">
              <span class="input-icon">ğŸ“¶</span>
              <input 
                type="text" 
                id="ssid" 
                name="ssid" 
                value="%WIFI_SSID%"
                placeholder="WiFi network name"
                required
              >
            </div>
          </div>
          
          <div class="form-group">
            <label for="wifiPass">Password <span class="required">*</span></label>
            <div class="input-wrapper">
              <span class="input-icon">ğŸ”’</span>
              <input 
                type="password" 
                id="wifiPass" 
                name="password" 
                value="%WIFI_PASS%"
                placeholder="WiFi password"
                required
              >
              <button type="button" class="password-toggle" aria-label="Show password">ğŸ‘ï¸</button>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Action Buttons -->
      <div class="btn-group">
        <button type="submit" class="btn btn-primary">
          ğŸ’¾ Save Configuration
        </button>
        <button type="button" class="btn btn-secondary" onclick="window.location.href='/dashboard'">
          âŒ Cancel
        </button>
      </div>
      
    </form>
  </main>
  
  <script src="/script.js"></script>
  <script>
    function toggleMQTT() {
      const mode = document.getElementById('commMode').value;
      const tokenGroup = document.getElementById('mqttToken');
      tokenGroup.style.display = mode === 'mqtt' ? 'block' : 'none';
    }
    
    // Initialize on page load
    toggleMQTT();
  </script>
</body>
</html>